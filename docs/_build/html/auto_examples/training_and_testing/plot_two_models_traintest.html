<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Regression: comparing two tabular models trained on simulated data &mdash; fusilli  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/florencestheme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/pink_pasta_logo.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Customising behaviour" href="../customising_behaviour/index.html" />
    <link rel="prev" title="Comparing Multiple K-Fold Trained Fusion Models" href="plot_model_comparison_loop_kfold.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            fusilli
              <img src="../../_static/pink_pasta_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">üå∏ Table of Contents üå∏</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Fusilli: an introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fusion_model_explanations.html">Fusion Model Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modifying_models.html">Modifying the fusion models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">üå∏ Tutorials üå∏</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#training-and-testing">Training and testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#customising-behaviour">Customising behaviour</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#how-to-create-your-own-fusion-model">How to create your own fusion model</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Training and testing</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="plot_one_model_binary_kfold.html">Binary: training one kfold model</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_model_comparison_loop_kfold.html">Comparing Multiple K-Fold Trained Fusion Models</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Regression: comparing two tabular models trained on simulated data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../customising_behaviour/index.html">Customising behaviour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../creating_your_own_fusion_model/index.html">How to create your own fusion model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">üå∏ API Reference üå∏</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.fusion_models.html">fusilli.fusion_models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.data.html">fusilli.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.train.html">fusilli.train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.eval.Plotter.html">fusilli.eval.Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.utils.model_chooser.html">fusilli.utils.model_chooser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.utils.training_utils.html">fusilli.utils.training_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.utils.model_modifier.html">fusilli.utils.model_modifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autosummary/fusilli.utils.check_model_validity.html">fusilli.utils.check_model_validity</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">fusilli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Tutorials and Examples Gallery</a></li>
          <li class="breadcrumb-item"><a href="index.html">Training and testing</a></li>
      <li class="breadcrumb-item active">Regression: comparing two tabular models trained on simulated data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/training_and_testing/plot_two_models_traintest.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-training-and-testing-plot-two-models-traintest-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="regression-comparing-two-tabular-models-trained-on-simulated-data">
<span id="sphx-glr-auto-examples-training-and-testing-plot-two-models-traintest-py"></span><h1>Regression: comparing two tabular models trained on simulated data<a class="headerlink" href="#regression-comparing-two-tabular-models-trained-on-simulated-data" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>This script shows how to train two fusion models on a regression task with train/test protocol and multimodal tabular data.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Importing models based on name.</p></li>
<li><p>Training and testing models with train/test protocol.</p></li>
<li><p>Saving trained models to a dictionary for later analysis.</p></li>
<li><p>Plotting the results of a single model.</p></li>
<li><p>Plotting the results of multiple models as a bar chart.</p></li>
<li><p>Saving the results of multiple models as a csv file.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">from</span> <span class="nn">docs.examples</span> <span class="kn">import</span> <span class="n">generate_sklearn_simulated_data</span>
<span class="kn">from</span> <span class="nn">fusilli.data</span> <span class="kn">import</span> <span class="n">get_data_module</span>
<span class="kn">from</span> <span class="nn">fusilli.eval</span> <span class="kn">import</span> <span class="n">Plotter</span>
<span class="kn">from</span> <span class="nn">fusilli.fusion_models.base_model</span> <span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span> <span class="nn">fusilli.train</span> <span class="kn">import</span> <span class="n">train_and_save_models</span>
<span class="kn">from</span> <span class="nn">fusilli.utils.model_chooser</span> <span class="kn">import</span> <span class="n">get_models</span>
</pre></div>
</div>
<section id="import-fusion-models">
<h2>1. Import fusion models<a class="headerlink" href="#import-fusion-models" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Here we import the fusion models to be compared. The models are imported using the
<a class="reference internal" href="../../autosummary/fusilli.utils.model_chooser.html#fusilli.utils.model_chooser.get_models" title="fusilli.utils.model_chooser.get_models"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_models()</span></code></a> function, which takes a dictionary of conditions
as an input. The conditions are the attributes of the models, e.g. the class name, the modality type, etc.</p>
<p>The function returns a dataframe of the models that match the conditions. The dataframe contains the
method name, the class name, the modality type, the fusion type, the path to the model, and the path to the
model‚Äôs parent class. The paths are used to import the models with the <code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.import_module()</span></code>.</p>
<p>We‚Äôre importing ConcatTabularData and TabularChannelWiseMultiAttention models for this example. Both are multimodal tabular models.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_conditions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;class_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ConcatTabularData&quot;</span><span class="p">,</span> <span class="s2">&quot;TabularChannelWiseMultiAttention&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">imported_models</span> <span class="o">=</span> <span class="n">get_models</span><span class="p">(</span><span class="n">model_conditions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imported methods:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imported_models</span><span class="o">.</span><span class="n">method_name</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">fusion_models</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># contains the class objects for each model</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">imported_models</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;method_path&quot;</span><span class="p">])</span>
    <span class="n">module_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class_name&quot;</span><span class="p">])</span>

    <span class="n">fusion_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_class</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Imported methods:
[&#39;Concatenating tabular data&#39; &#39;Channel-wise multiplication net (tabular)&#39;]
</pre></div>
</div>
</section>
<section id="set-the-training-parameters">
<h2>2. Set the training parameters<a class="headerlink" href="#set-the-training-parameters" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Here we define the parameters for training and testing the models. The parameters are stored in a dictionary and passed to most
of the methods in this library.
For training and testing, the necessary parameters are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test_size</span></code>: the proportion of the data to be used for testing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kfold_flag</span></code>: the user sets this to False for train/test protocol.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log</span></code>: a boolean of whether to log the results using Weights and Biases.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pred_type</span></code>: the type of prediction to be performed. This is either <code class="docutils literal notranslate"><span class="pre">regression</span></code>, <code class="docutils literal notranslate"><span class="pre">binary</span></code>, or <code class="docutils literal notranslate"><span class="pre">classification</span></code>. For this example we‚Äôre using regression.</p></li>
</ul>
<p>If we were going to use a subspace-based fusion model, we would also need to set the latent dimensionality of the subspace with <code class="docutils literal notranslate"><span class="pre">subspace_latdims</span></code>. This will be shown in a different example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;test_size&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s2">&quot;kfold_flag&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;pred_type&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="generating-simulated-data">
<h2>3. Generating simulated data<a class="headerlink" href="#generating-simulated-data" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Here we generate simulated data for the two tabular modalities for this example.
This function also simulated image data which we aren‚Äôt using here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">generate_sklearn_simulated_data</span><span class="p">(</span>
    <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">num_tab1_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_tab2_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">img_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="training-the-first-fusion-model">
<h2>4. Training the first fusion model<a class="headerlink" href="#training-the-first-fusion-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Here we train the first fusion model. We‚Äôre using the <code class="docutils literal notranslate"><span class="pre">train_and_save_models</span></code> function to train and test the models.
This function takes the following inputs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trained_models_dict</span></code>: a dictionary to store the trained models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_module</span></code>: the data module containing the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: the parameters for training and testing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fusion_model</span></code>: the fusion model to be trained.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_model</span></code>: the initialised dummy fusion model.</p></li>
</ul>
<p>First we‚Äôll create a dictionary to store both the trained models so we can compare them later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_trained_models</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># create dictionary to store trained models</span>
</pre></div>
</div>
<p>To train the first model we need to:</p>
<ol class="arabic simple">
<li><p><em>Choose the model</em>: We‚Äôre using the first model in the <code class="docutils literal notranslate"><span class="pre">fusion_models</span></code> list we made earlier.</p></li>
<li><p><em>Create a dictionary to store the trained model</em>: We‚Äôre using the name of the model as the key. It may seem overkill to make a dictionary just to store one model, but we also use this when we do k-fold training to store the trained models from the different folds.</p></li>
<li><p><em>Initialise the model with dummy data</em>: This is so we can find out whether there are extra instructions for creating the datamodule (such as a method for creating a graph datamodule).</p></li>
<li><p><em>Print the attributes of the model</em>: To check it‚Äôs been initialised correctly.</p></li>
<li><p><em>Create the datamodule</em>: This is done with the <a class="reference internal" href="../../autosummary/fusilli.data.html#fusilli.data.get_data_module" title="fusilli.data.get_data_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_data_module()</span></code></a> function. This function takes the initialised model and the parameters as inputs. It returns the datamodule.</p></li>
<li><p><em>Train and test the model</em>: This is done with the <a class="reference internal" href="../../autosummary/fusilli.train.html#fusilli.train.train_and_save_models" title="fusilli.train.train_and_save_models"><code class="xref py py-func docutils literal notranslate"><span class="pre">train_and_save_models()</span></code></a> function. This function takes the trained_models_dict, the datamodule, the parameters, the fusion model, and the initialised model as inputs. It returns the trained_models_dict with the trained model added to it.</p></li>
<li><p><em>Add the trained model to the ``all_trained_models`` dictionary</em>: This is so we can compare the results of the two models later.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fusion_model</span> <span class="o">=</span> <span class="n">fusion_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method name:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">method_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modality type:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">modality_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fusion type:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">fusion_type</span><span class="p">)</span>

<span class="c1"># Create the data module</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">get_data_module</span><span class="p">(</span><span class="n">fusion_model</span><span class="o">=</span><span class="n">fusion_model</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Train and test</span>
<span class="n">model_1_dict</span> <span class="o">=</span> <span class="n">train_and_save_models</span><span class="p">(</span>
    <span class="n">data_module</span><span class="o">=</span><span class="n">dm</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
    <span class="n">fusion_model</span><span class="o">=</span><span class="n">fusion_model</span><span class="p">,</span>
    <span class="n">enable_checkpointing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># False for the example notebooks</span>
<span class="p">)</span>

<span class="c1"># Add trained model to dictionary</span>
<span class="n">all_trained_models</span><span class="p">[</span><span class="n">fusion_model</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_1_dict</span><span class="p">[</span><span class="n">fusion_model</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/Users/florencetownend/Library/CloudStorage/OneDrive-UniversityCollegeLondon/Projects/fusilli/docs/examples/training_and_testing/plot_two_models_traintest.py&quot;</span>, line <span class="m">131</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">model_1_dict</span> <span class="o">=</span> <span class="n">train_and_save_models</span><span class="p">(</span>
  File <span class="nb">&quot;/Users/florencetownend/Library/CloudStorage/OneDrive-UniversityCollegeLondon/Projects/fusilli/fusilli/train.py&quot;</span>, line <span class="m">251</span>, in <span class="n">train_and_save_models</span>
    <span class="n">trained_model</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">checkpoint_callback</span><span class="o">.</span><span class="n">best_model_path</span><span class="p">,</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;NoneType&#39; object has no attribute &#39;best_model_path&#39;</span>
</pre></div>
</div>
</section>
<section id="plotting-the-results-of-the-first-model">
<h2>5. Plotting the results of the first model<a class="headerlink" href="#plotting-the-results-of-the-first-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>We‚Äôre using the <a class="reference internal" href="../../autosummary/fusilli.eval.Plotter.html#fusilli.eval.Plotter" title="fusilli.eval.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a> class to plot the results of the first model. This class takes the dictionary of trained models and the parameters as inputs. It returns a dictionary of figures.
If there is one model in the dictionary (i.e. only one unique key), then it plots the figures for analysing the results of a single model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">model_1_dict</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">single_model_figures_dict</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">show_all</span><span class="p">(</span><span class="n">single_model_figures_dict</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="training-the-second-fusion-model">
<h2>6. Training the second fusion model<a class="headerlink" href="#training-the-second-fusion-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Here we train the second fusion model: TabularChannelWiseMultiAttention. We‚Äôre using the same steps as before, but this time we‚Äôre using the second model in the <code class="docutils literal notranslate"><span class="pre">fusion_models</span></code> list.</p>
<p>Choose the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fusion_model</span> <span class="o">=</span> <span class="n">fusion_models</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method name:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">method_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modality type:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">modality_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fusion type:&quot;</span><span class="p">,</span> <span class="n">fusion_model</span><span class="o">.</span><span class="n">fusion_type</span><span class="p">)</span>

<span class="c1"># Create the data module</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">get_data_module</span><span class="p">(</span><span class="n">fusion_model</span><span class="o">=</span><span class="n">fusion_model</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Train and test</span>
<span class="n">model_2_dict</span> <span class="o">=</span> <span class="n">train_and_save_models</span><span class="p">(</span>
    <span class="n">data_module</span><span class="o">=</span><span class="n">dm</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
    <span class="n">fusion_model</span><span class="o">=</span><span class="n">fusion_model</span><span class="p">,</span>
    <span class="n">enable_checkpointing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># False for the example notebooks</span>
<span class="p">)</span>

<span class="c1"># Add trained model to dictionary</span>
<span class="n">all_trained_models</span><span class="p">[</span><span class="n">fusion_model</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_2_dict</span><span class="p">[</span><span class="n">fusion_model</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="plotting-the-results-of-the-second-model">
<h2>7. Plotting the results of the second model<a class="headerlink" href="#plotting-the-results-of-the-second-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">model_2_dict</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">single_model_figures_dict</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">show_all</span><span class="p">(</span><span class="n">single_model_figures_dict</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="comparing-the-results-of-the-two-models">
<h2>8. Comparing the results of the two models<a class="headerlink" href="#comparing-the-results-of-the-two-models" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Now we‚Äôre going to compare the results of the two models. We‚Äôre using the same steps as when we used Plotter before, but this time we‚Äôre using the <code class="docutils literal notranslate"><span class="pre">all_trained_models</span></code> dictionary which contains both models.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">comparison_plotter</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">all_trained_models</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="n">comparison_plot_dict</span> <span class="o">=</span> <span class="n">comparison_plotter</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
<span class="n">comparison_plotter</span><span class="o">.</span><span class="n">show_all</span><span class="p">(</span><span class="n">comparison_plot_dict</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="saving-the-metrics-of-the-two-models">
<h2>9. Saving the metrics of the two models<a class="headerlink" href="#saving-the-metrics-of-the-two-models" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>We can also get the metrics of the two models into a Pandas DataFrame using the <a class="reference internal" href="../../autosummary/fusilli.eval.Plotter.html#fusilli.eval.Plotter.get_performance_df" title="fusilli.eval.Plotter.get_performance_df"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_performance_df()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">performances_df</span> <span class="o">=</span> <span class="n">comparison_plotter</span><span class="o">.</span><span class="n">get_performance_df</span><span class="p">()</span>
<span class="n">performances_df</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 3.785 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-training-and-testing-plot-two-models-traintest-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5e58dc209c61667c4b2d3d37eb80ec1c/plot_two_models_traintest.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_two_models_traintest.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5336dc01555859101a7c2bdbe3fab305/plot_two_models_traintest.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_two_models_traintest.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_model_comparison_loop_kfold.html" class="btn btn-neutral float-left" title="Comparing Multiple K-Fold Trained Fusion Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../customising_behaviour/index.html" class="btn btn-neutral float-right" title="Customising behaviour" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Florence J Townend.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>