<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fusion_models package &mdash; fusilli  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/florencestheme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/pink_pasta_logo.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fusilli
              <img src="../_static/pink_pasta_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">🌸 Table of Contents 🌸</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Fusilli: an introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fusion_model_explanations.html">Fusion Model Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modifying_models.html">Modifying the fusion models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🌸 Tutorials 🌸</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Tutorials and Examples Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🌸 API Reference 🌸</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autosummary/fusilli.fusion_models.html">fusilli.fusion_models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autosummary/fusilli.data.html">fusilli.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autosummary/fusilli.train.html">fusilli.train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autosummary/fusilli.eval.html">fusilli.eval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autosummary/fusilli.utils.html">fusilli.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fusilli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">fusion_models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/fusion_models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fusion-models-package">
<h1>fusion_models package<a class="headerlink" href="#fusion-models-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-fusion_models.base_model">
<span id="fusion-models-base-model-module"></span><h2>fusion_models.base_model module<a class="headerlink" href="#module-fusion_models.base_model" title="Permalink to this heading"></a></h2>
<p>Base lightning module for all fusion models and parent class for all fusion models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Base pytorch lightning model for all fusion models.</p>
<p>This class takes the specific fusion model as an input and provides the training and validation
steps.
The loss functions/metrics/activation function options are defined here and chosen based on the
prediction type
chosen by the user.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.model" title="Permalink to this definition"></a></dt>
<dd><p>Fusion model class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.multiclass_dim">
<span class="sig-name descname"><span class="pre">multiclass_dim</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.multiclass_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of classes for multiclass prediction. Default is 3 for making the metrics dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.train_mask">
<span class="sig-name descname"><span class="pre">train_mask</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.train_mask" title="Permalink to this definition"></a></dt>
<dd><p>Mask for training data, used for the graph fusion methods instead of train/val split.
Indicates which nodes are training nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.val_mask">
<span class="sig-name descname"><span class="pre">val_mask</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.val_mask" title="Permalink to this definition"></a></dt>
<dd><p>Mask for validation data - used for the graph fusion methods instead of train/val split.
Indicates which nodes are validation nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.loss_functions">
<span class="sig-name descname"><span class="pre">loss_functions</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.loss_functions" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of loss functions, one for each prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.output_activation_functions">
<span class="sig-name descname"><span class="pre">output_activation_functions</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.output_activation_functions" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of output activation functions, one for each prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.metrics" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of metrics, two for each prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.batch_val_reals">
<span class="sig-name descname"><span class="pre">batch_val_reals</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.batch_val_reals" title="Permalink to this definition"></a></dt>
<dd><p>List of validation reals for each batch. Stored for later concatenation with rest of
batches and access by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.batch_val_preds">
<span class="sig-name descname"><span class="pre">batch_val_preds</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.batch_val_preds" title="Permalink to this definition"></a></dt>
<dd><p>List of validation preds for each batch. Stored for later concatenation with rest of
batches and access by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.batch_val_logits">
<span class="sig-name descname"><span class="pre">batch_val_logits</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.batch_val_logits" title="Permalink to this definition"></a></dt>
<dd><p>List of validation logits for each batch. Stored for later concatenation with rest of
batches and access by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.batch_train_reals">
<span class="sig-name descname"><span class="pre">batch_train_reals</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.batch_train_reals" title="Permalink to this definition"></a></dt>
<dd><p>List of training reals for each batch. Stored for later concatenation with rest of batches
and access by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.batch_train_preds">
<span class="sig-name descname"><span class="pre">batch_train_preds</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.batch_train_preds" title="Permalink to this definition"></a></dt>
<dd><p>List of training preds for each batch. Stored for later concatenation with rest of batches
and access by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.val_reals">
<span class="sig-name descname"><span class="pre">val_reals</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.val_reals" title="Permalink to this definition"></a></dt>
<dd><p>Concatenated validation reals for all batches. Accessed by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.val_preds">
<span class="sig-name descname"><span class="pre">val_preds</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.val_preds" title="Permalink to this definition"></a></dt>
<dd><p>Concatenated validation preds for all batches. Accessed by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.val_logits">
<span class="sig-name descname"><span class="pre">val_logits</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.val_logits" title="Permalink to this definition"></a></dt>
<dd><p>Concatenated validation logits for all batches. Accessed by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.train_reals">
<span class="sig-name descname"><span class="pre">train_reals</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.train_reals" title="Permalink to this definition"></a></dt>
<dd><p>Concatenated training reals for all batches. Accessed by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.train_preds">
<span class="sig-name descname"><span class="pre">train_preds</span></span><a class="headerlink" href="#fusion_models.base_model.BaseModel.train_preds" title="Permalink to this definition"></a></dt>
<dd><p>Concatenated training preds for all batches. Accessed by Plotter class for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>class</em>) – Fusion model class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.configure_optimizers" title="Permalink to this definition"></a></dt>
<dd><p>Configure optimizers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.get_data_from_batch">
<span class="sig-name descname"><span class="pre">get_data_from_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.get_data_from_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.get_data_from_batch" title="Permalink to this definition"></a></dt>
<dd><p>Get data from batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>tensor</em>) – Batch of data.</p></li>
<li><p><strong>train</strong> (<em>bool</em>) – Whether the data is training data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – Input data.</p></li>
<li><p><strong>y</strong> (<em>tensor</em>) – Labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.get_model_outputs">
<span class="sig-name descname"><span class="pre">get_model_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.get_model_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.get_model_outputs" title="Permalink to this definition"></a></dt>
<dd><p>Get model outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>logits</strong> (<em>tensor</em>) – Logits.</p></li>
<li><p><strong>reconstructions</strong> (<em>tensor</em>) – Reconstructions (returned if the model has a custom loss function such as a subspace method)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if you get an error here, check that the forward output in fusion model is [out,] or [out, reconstructions]</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.get_model_outputs_and_loss">
<span class="sig-name descname"><span class="pre">get_model_outputs_and_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.get_model_outputs_and_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.get_model_outputs_and_loss" title="Permalink to this definition"></a></dt>
<dd><p>Get model outputs and loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – Input data.</p></li>
<li><p><strong>y</strong> (<em>tensor</em>) – Labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>loss</strong> (<em>tensor</em>) – Loss.</p></li>
<li><p><strong>end_output</strong> (<em>tensor</em>) – Final output.</p></li>
<li><p><strong>logits</strong> (<em>tensor</em>) – Logits.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.predict_step" title="Permalink to this definition"></a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it
calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(accelerator=&quot;tpu&quot;,</span> <span class="pre">devices=8)</span></code> as predictions won’t be returned.</p>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">predict_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Current batch.</p></li>
<li><p><strong>batch_idx</strong> – Index of current batch.</p></li>
<li><p><strong>dataloader_idx</strong> – Index of the current dataloader.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.safe_squeeze">
<span class="sig-name descname"><span class="pre">safe_squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.safe_squeeze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.safe_squeeze" title="Permalink to this definition"></a></dt>
<dd><p>Squeeze tensor if it is not 1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>tensor</em>) – Tensor to be squeezed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Squeezed tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.base_model.BaseModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Training step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>tensor</em>) – Batch of data.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>loss</strong> – Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.validation_epoch_end">
<span class="sig-name descname"><span class="pre">validation_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.validation_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Gets the final validation epoch outputs and metrics.
When metrics are calculated at the validation step and logged on on_epoch=True,
the batch metrics are averaged. However, some metrics don’t average well (e.g. R2).
Therefore, we’re calculating the final validation metrics here on the full validation set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.BaseModel.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#BaseModel.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.BaseModel.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Validation step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>tensor</em>) – Batch of data.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParentFusionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent class for all fusion models.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be made. Options: binary, multiclass, regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.mod1_dim">
<span class="sig-name descname"><span class="pre">mod1_dim</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.mod1_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of modality 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.mod2_dim">
<span class="sig-name descname"><span class="pre">mod2_dim</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.mod2_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of modality 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.img_dim">
<span class="sig-name descname"><span class="pre">img_dim</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.img_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimensions of image modality. If using 2D images, then the dimensions will be (x, y). If using 3D images, then
the dimensions will be (x, y, z).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.params" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.multiclass_dim">
<span class="sig-name descname"><span class="pre">multiclass_dim</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.multiclass_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of classes for multiclass prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.kfold_flag">
<span class="sig-name descname"><span class="pre">kfold_flag</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.kfold_flag" title="Permalink to this definition"></a></dt>
<dd><p>Whether to use k-fold cross validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Modality 1 layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Modality 2 layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be made. Options: binary, multiclass, regression.</p></li>
<li><p><strong>data_dims</strong> (<em>list</em>) – List of data dimensions.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary of parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.set_final_pred_layers">
<span class="sig-name descname"><span class="pre">set_final_pred_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.set_final_pred_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.set_final_pred_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sets final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_dim</strong> (<em>int</em>) – Input dimension to final layers - may depend on fusion configuration.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.set_fused_layers">
<span class="sig-name descname"><span class="pre">set_fused_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fused_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.set_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.set_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Set layers for fused modality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fused_dim</strong> (<em>int</em>) – Dimension of fused modality: how many features are there after fusion?
e.g. if we have 2 modalities with 64 features each, and the fusion method
was concatenation, the fused_dim would be 128</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.set_img_layers">
<span class="sig-name descname"><span class="pre">set_img_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.set_img_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.set_img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sets layers for image modality. If using 2D images, then the layers will use Conv2D layers.
If using 3D images, then the layers will use Conv3D layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.set_mod1_layers">
<span class="sig-name descname"><span class="pre">set_mod1_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.set_mod1_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.set_mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sets layers for modality 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.base_model.ParentFusionModel.set_mod2_layers">
<span class="sig-name descname"><span class="pre">set_mod2_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/base_model.html#ParentFusionModel.set_mod2_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.base_model.ParentFusionModel.set_mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sets layers for modality 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_img_latent_tab_doubleloss">
<span id="fusion-models-concat-img-latent-tab-doubleloss-module"></span><h2>fusion_models.concat_img_latent_tab_doubleloss module<a class="headerlink" href="#module-fusion_models.concat_img_latent_tab_doubleloss" title="Permalink to this heading"></a></h2>
<p>Concat image latent space with tabular data, trained altogether with a custom loss function: MSE + BCE.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatImgLatentTabDoubleLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubleloss.html#ConcatImgLatentTabDoubleLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating image latent space with tabular data, trained altogether with a custom loss
function: MSE + BCE.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed. Binary, regression or multiclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers defined with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.custom_loss">
<span class="sig-name descname"><span class="pre">custom_loss</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.custom_loss" title="Permalink to this definition"></a></dt>
<dd><p>Additional loss function to be used for training the model. Default is MSELoss.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.latent_dim">
<span class="sig-name descname"><span class="pre">latent_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.latent_dim" title="Permalink to this definition"></a></dt>
<dd><p>Size of the latent space. Default is 256.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.encoder">
<span class="sig-name descname"><span class="pre">encoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.encoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the encoder layers. Default for 2D image is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.decoder">
<span class="sig-name descname"><span class="pre">decoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.decoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the decoder layers. Default for 2D image is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.new_encoder">
<span class="sig-name descname"><span class="pre">new_encoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.new_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the encoder layers and the additional layers defined with
<a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.new_decoder">
<span class="sig-name descname"><span class="pre">new_decoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.new_decoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the decoder layers and the additional layers defined with
<a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Size of the fused layers: latent dimension size + tabular data dimension size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubleloss.html#ConcatImgLatentTabDoubleLoss.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubleloss.html#ConcatImgLatentTabDoubleLoss.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers. If layer sizes are modified, this function will be called again to adjust the
fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubleloss.html#ConcatImgLatentTabDoubleLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>list</strong> – List containing the output data: prediction and reconstructed image.
[ [prediction], [reconstructed_image] ]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'subspace'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubleloss.html#ConcatImgLatentTabDoubleLoss.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">image</span> <span class="pre">latent</span> <span class="pre">space</span> <span class="pre">with</span> <span class="pre">tabular</span> <span class="pre">data,</span> <span class="pre">trained</span> <span class="pre">altogether'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubleloss.ConcatImgLatentTabDoubleLoss.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_img_latent_tab_doubletrain">
<span id="fusion-models-concat-img-latent-tab-doubletrain-module"></span><h2>fusion_models.concat_img_latent_tab_doubletrain module<a class="headerlink" href="#module-fusion_models.concat_img_latent_tab_doubletrain" title="Permalink to this heading"></a></h2>
<p>Concatenating the latent img space and tabular data. The latent image space is
trained separately from both the tabular data and the labels, using the
img_latent_subspace_method class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatImgLatentTabDoubleTrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ConcatImgLatentTabDoubleTrain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating the latent img space and tabular data. The latent image space is
trained separately from both the tabular data and the labels, using the
img_latent_subspace_method class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.latent_dim">
<span class="sig-name descname"><span class="pre">latent_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.latent_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the latent image space once we encode it down. Taken from the
subspace_method class and inferred from the dimensions of the input data to the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.enc_img_layer">
<span class="sig-name descname"><span class="pre">enc_img_layer</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.enc_img_layer" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer to reduce the dimension of the latent image space.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the fused layers.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ConcatImgLatentTabDoubleTrain.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ConcatImgLatentTabDoubleTrain.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers. If layer sizes are modified, this function will be called again
to adjust the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ConcatImgLatentTabDoubleTrain.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'subspace'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ConcatImgLatentTabDoubleTrain.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">latent</span> <span class="pre">img</span> <span class="pre">space</span> <span class="pre">and</span> <span class="pre">tabular</span> <span class="pre">data</span> <span class="pre">training</span> <span class="pre">separately'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.subspace_method">
<span class="sig-name descname"><span class="pre">subspace_method</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.subspace_method" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method" title="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method"><code class="xref py py-class docutils literal notranslate"><span class="pre">concat_img_latent_tab_subspace_method</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ConcatImgLatentTabDoubleTrain.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ImgLatentSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Pytorch lightning module: autoencoder to train the latent image space.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.data_dims">
<span class="sig-name descname"><span class="pre">data_dims</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.data_dims" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the dimensions of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.img_dim">
<span class="sig-name descname"><span class="pre">img_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.img_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimensions of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.latent_dim">
<span class="sig-name descname"><span class="pre">latent_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.latent_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the latent image space once we encode it down. Default is 64.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.encoder">
<span class="sig-name descname"><span class="pre">encoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.encoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the encoder layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.decoder">
<span class="sig-name descname"><span class="pre">decoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.decoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the decoder layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.new_encoder">
<span class="sig-name descname"><span class="pre">new_encoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.new_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the encoder layers and the linear layer to reduce the dimension
of the latent image space.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.new_decoder">
<span class="sig-name descname"><span class="pre">new_decoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.new_decoder" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the decoder layers and the linear layer to increase the
dimension of the latent image space.
Calculated with <a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers" title="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers. If layer sizes are modified, this function will be called again to adjust the
fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.configure_optimizers" title="Permalink to this definition"></a></dt>
<dd><p>Configure the optimizers of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adam optimizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.optim.Adam</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.encode_image">
<span class="sig-name descname"><span class="pre">encode_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.encode_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.encode_image" title="Permalink to this definition"></a></dt>
<dd><p>Encode the image data. Used when the model is trained to get latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Encoded image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of the model. Reconstruction/decoded image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Training step of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Batch of data.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Index of the batch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#ImgLatentSpace.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Validation step of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Batch of data.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Index of the batch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concat_img_latent_tab_subspace_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#concat_img_latent_tab_subspace_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing the method to train the latent image space and to convert the image data
to the latent image space.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.datamodule">
<span class="sig-name descname"><span class="pre">datamodule</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.datamodule" title="Permalink to this definition"></a></dt>
<dd><p>Data module containing the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pl.LightningDataModule</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.trainer" title="Permalink to this definition"></a></dt>
<dd><p>Lightning trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pytorch_lightning.Trainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.autoencoder">
<span class="sig-name descname"><span class="pre">autoencoder</span></span><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.autoencoder" title="Permalink to this definition"></a></dt>
<dd><p>Autoencoder to train the latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace" title="fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace">ImgLatentSpace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#concat_img_latent_tab_subspace_method.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datamodule</strong> (<em>pl.LightningDataModule</em>) – Data module containing the data.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs to train the latent image space.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>list</em>) – List containing the path to the checkpoint of the latent image space.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.convert_to_latent">
<span class="sig-name descname"><span class="pre">convert_to_latent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#concat_img_latent_tab_subspace_method.convert_to_latent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.convert_to_latent" title="Permalink to this definition"></a></dt>
<dd><p>Convert the image data to the latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_dataset</strong> (<em>Dataset</em>) – Test dataset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – List containing the raw tabular data and the latent image space.</p></li>
<li><p><em>pd.DataFrame</em> – Dataframe containing the labels.</p></li>
<li><p><em>list</em> – List containing the dimensions of the data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.subspace_models">
<span class="sig-name descname"><span class="pre">subspace_models</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;class</span> <span class="pre">'fusion_models.concat_img_latent_tab_doubletrain.ImgLatentSpace'&gt;]</span></em><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.subspace_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_latent_tab_doubletrain.html#concat_img_latent_tab_subspace_method.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_latent_tab_doubletrain.concat_img_latent_tab_subspace_method.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataset</strong> (<em>Dataset</em>) – Training dataset.</p></li>
<li><p><strong>val_dataset</strong> (<em>Dataset</em>) – Validation dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – List containing the raw tabular data and the latent image space.</p></li>
<li><p><em>pd.DataFrame</em> – Dataframe containing the labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_img_maps_tabular_data">
<span id="fusion-models-concat-img-maps-tabular-data-module"></span><h2>fusion_models.concat_img_maps_tabular_data module<a class="headerlink" href="#module-fusion_models.concat_img_maps_tabular_data" title="Permalink to this heading"></a></h2>
<p>Concatenating the input data of the first tabular modality and the feature maps of the
image modality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatImageMapsTabularData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_data.html#ConcatImageMapsTabularData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating the input data of the first tabular modalities and the feature maps of the
image modality.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers. Calculated in the
<a class="reference internal" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers" title="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input.
Calculated in the <a class="reference internal" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers" title="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. Calculated in the
<a class="reference internal" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers" title="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_data.html#ConcatImageMapsTabularData.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_data.html#ConcatImageMapsTabularData.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_data.html#ConcatImageMapsTabularData.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'operation'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.fusion_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of fusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_data.html#ConcatImageMapsTabularData.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">tabular</span> <span class="pre">data</span> <span class="pre">with</span> <span class="pre">image</span> <span class="pre">feature</span> <span class="pre">maps'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.method_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.modality_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_data.ConcatImageMapsTabularData.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_img_maps_tabular_maps">
<span id="fusion-models-concat-img-maps-tabular-maps-module"></span><h2>fusion_models.concat_img_maps_tabular_maps module<a class="headerlink" href="#module-fusion_models.concat_img_maps_tabular_maps" title="Permalink to this heading"></a></h2>
<p>Concatenating the feature maps of the first tabular modality and the feature maps of the
image modality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatImageMapsTabularMaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_maps.html#ConcatImageMapsTabularMaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating the feature maps of the first tabular modalities and the feature maps of the
image modality.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the first modality.
Calculated in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_mod1_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.
Calculated in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_img_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. In this method, it’s the size of the tabular layers
output plus the size of the (flattened) image layers output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers. Calculated in the
<a class="reference internal" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers" title="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input.
Calculated in the <a class="reference internal" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers" title="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_maps.html#ConcatImageMapsTabularMaps.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_maps.html#ConcatImageMapsTabularMaps.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_maps.html#ConcatImageMapsTabularMaps.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'operation'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_img_maps_tabular_maps.html#ConcatImageMapsTabularMaps.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">tabular</span> <span class="pre">and</span> <span class="pre">image</span> <span class="pre">feature</span> <span class="pre">maps'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_img_maps_tabular_maps.ConcatImageMapsTabularMaps.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_tabular_data">
<span id="fusion-models-concat-tabular-data-module"></span><h2>fusion_models.concat_tabular_data module<a class="headerlink" href="#module-fusion_models.concat_tabular_data" title="Permalink to this heading"></a></h2>
<p>Concatenating the two tabular modalities at the data-level (early fusion)</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatTabularData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_data.html#ConcatTabularData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating the two tabular modalities at the data-level (early fusion)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. In this method, it’s the tabular 1 dimension plus
the tabular 2 dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers. Calculated in the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_fused_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input.
Calculated in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_final_pred_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_data.html#ConcatTabularData.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_data.html#ConcatTabularData.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_data.html#ConcatTabularData.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the data of the two modalities.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'operation'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_data.html#ConcatTabularData.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">tabular</span> <span class="pre">data'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_data.ConcatTabularData.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_tabular_data.ConcatTabularData.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.concat_tabular_feature_maps">
<span id="fusion-models-concat-tabular-feature-maps-module"></span><h2>fusion_models.concat_tabular_feature_maps module<a class="headerlink" href="#module-fusion_models.concat_tabular_feature_maps" title="Permalink to this heading"></a></h2>
<p>Concatenating the feature maps of the two tabular modalities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConcatTabularFeatureMaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_feature_maps.html#ConcatTabularFeatureMaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Concatenating the feature maps of the two tabular modalities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the first modality. Calculated in the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_mod1_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the second modality. Calculated in the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_mod2_layers()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. In this method, it’s the size of the tabular 1
layers output plus the size of the tabular 2 layers output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers. Calculated in the
<a class="reference internal" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers" title="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in the number of features of the fused layers as input. Calculated in the
<a class="reference internal" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers" title="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_fused_layers()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_feature_maps.html#ConcatTabularFeatureMaps.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_feature_maps.html#ConcatTabularFeatureMaps.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_feature_maps.html#ConcatTabularFeatureMaps.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'operation'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/concat_tabular_feature_maps.html#ConcatTabularFeatureMaps.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Concatenating</span> <span class="pre">tabular</span> <span class="pre">feature</span> <span class="pre">maps'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.concat_tabular_feature_maps.ConcatTabularFeatureMaps.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.crossmodal_att">
<span id="fusion-models-crossmodal-att-module"></span><h2>fusion_models.crossmodal_att module<a class="headerlink" href="#module-fusion_models.crossmodal_att" title="Permalink to this heading"></a></h2>
<p>Crossmodal multi-head attention model. This model uses the self attention and cross modal attention
between the two modalities: tabular and image.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CrossmodalMultiheadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/crossmodal_att.html#CrossmodalMultiheadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Crossmodal multi-head attention model. This model uses the self attention and cross modal
attention between the two modalities: tabular and image.</p>
<p class="rubric">References</p>
<p>Golovanevsky, M., Eickhoff, C., &amp; Singh, R. (2022). Multimodal attention-based
deep learning for Alzheimer’s disease diagnosis.
Journal of the American Medical Informatics Association, 29(12),
2014–2022. <a class="reference external" href="https://doi.org/10.1093/jamia/ocac168">https://doi.org/10.1093/jamia/ocac168</a></p>
<p><a class="reference external" href="https://github.com/rsinghlab/MADDi/blob/main/training/train_all_modalities.py">https://github.com/rsinghlab/MADDi/blob/main/training/train_all_modalities.py</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.attention_embed_dim">
<span class="sig-name descname"><span class="pre">attention_embed_dim</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.attention_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the first modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the flattened output size of the
image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.attention">
<span class="sig-name descname"><span class="pre">attention</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.attention" title="Permalink to this definition"></a></dt>
<dd><p>Multihead attention layer. Takes in attention_embed_dim features as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.MultiheadAttention</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_dense">
<span class="sig-name descname"><span class="pre">img_dense</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_dense" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer. Takes in attention_embed_dim features as input. This is the output of
the multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_to_embed_dim">
<span class="sig-name descname"><span class="pre">img_to_embed_dim</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.img_to_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer. Takes in fused_dim features as input. This is the input of the
multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.tab_to_embed_dim">
<span class="sig-name descname"><span class="pre">tab_to_embed_dim</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.tab_to_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer. Takes in fused_dim features as input. This is the input of the
multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.relu">
<span class="sig-name descname"><span class="pre">relu</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.relu" title="Permalink to this definition"></a></dt>
<dd><p>ReLU activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ReLU</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/crossmodal_att.html#CrossmodalMultiheadAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/crossmodal_att.html#CrossmodalMultiheadAttention.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the number of layers in the two modalities is different.</p></li>
<li><p><strong>ValueError</strong> – If dtype of the layers is not nn.ModuleDict.</p></li>
<li><p><strong>ValueError</strong> – If the image dimensions are not valid. (Conv2D used for 3D img and vice versa)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/crossmodal_att.html#CrossmodalMultiheadAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'attention'</span></em><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/crossmodal_att.html#CrossmodalMultiheadAttention.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Crossmodal</span> <span class="pre">multi-head</span> <span class="pre">attention'</span></em><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.crossmodal_att.CrossmodalMultiheadAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.crossmodal_att.CrossmodalMultiheadAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.denoise_tab_img_maps">
<span id="fusion-models-denoise-tab-img-maps-module"></span><h2>fusion_models.denoise_tab_img_maps module<a class="headerlink" href="#module-fusion_models.denoise_tab_img_maps" title="Permalink to this heading"></a></h2>
<p>Denoising autoencoder for tabular data concatenated with image feature maps</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DAETabImgMaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DAETabImgMaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Using a denoising autoencoder to upsample tabular data, then concatenating with feature maps
from final 3 conv layers of image data.
From Yan et al 2021: Richer fusion network for breast cancer classification on multimodal data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.subspace_method">
<span class="sig-name descname"><span class="pre">subspace_method</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.subspace_method" title="Permalink to this definition"></a></dt>
<dd><p>Subspace method:
<a class="reference internal" href="../autosummary/fusilli.fusion_models.denoise_tab_img_maps.html#fusilli.fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method" title="fusilli.fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method"><code class="xref py py-class docutils literal notranslate"><span class="pre">denoising_autoencoder_subspace_method</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.fusion_layers">
<span class="sig-name descname"><span class="pre">fusion_layers</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.fusion_layers" title="Permalink to this definition"></a></dt>
<dd><p>Fusion layers combining the intermediate image maps and the tabular latent subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DAETabImgMaps.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialise the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction.</p></li>
<li><p><strong>data_dims</strong> (<em>list</em>) – List containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DAETabImgMaps.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DAETabImgMaps.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'subspace'</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Denoising</span> <span class="pre">tabular</span> <span class="pre">autoencoder</span> <span class="pre">with</span> <span class="pre">image</span> <span class="pre">maps'</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">subspace_method</span></span><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method" title="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method"><code class="xref py py-class docutils literal notranslate"><span class="pre">denoising_autoencoder_subspace_method</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DAETabImgMaps.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DAETabImgMaps.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DenoisingAutoencoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Denoising autoencoder for tabular data: pytorch lightning module.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.tab_dims">
<span class="sig-name descname"><span class="pre">tab_dims</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.tab_dims" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the input tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.subspace_lat_dims">
<span class="sig-name descname"><span class="pre">subspace_lat_dims</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.subspace_lat_dims" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the latent subspace (should be larger than tab_dims for a DAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.upsampler">
<span class="sig-name descname"><span class="pre">upsampler</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.upsampler" title="Permalink to this definition"></a></dt>
<dd><p>Upsampling layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.downsampler">
<span class="sig-name descname"><span class="pre">downsampler</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.downsampler" title="Permalink to this definition"></a></dt>
<dd><p>Downsampling layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.loss" title="Permalink to this definition"></a></dt>
<dd><p>Loss function. In this case, it’s the mean squared error.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialise the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_dims</strong> (<em>list</em>) – List containing the dimensions of the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.configure_optimizers" title="Permalink to this definition"></a></dt>
<dd><p>Configure the optimizers of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adam optimizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.optim.Adam</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.denoise">
<span class="sig-name descname"><span class="pre">denoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.denoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.denoise" title="Permalink to this definition"></a></dt>
<dd><p>Denoise the data to create the latent subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Latent subspace.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Training step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Input batch.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#DenoisingAutoencoder.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Validation step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Input batch.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ImgUnimodalDAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiclass_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Image unimodal network to go alongside the tabular denoising autoencoder: pytorch
lightning module.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.img_dim">
<span class="sig-name descname"><span class="pre">img_dim</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.img_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the input image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.multiclass_dim">
<span class="sig-name descname"><span class="pre">multiclass_dim</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.multiclass_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of classes for multiclass classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.num_layers">
<span class="sig-name descname"><span class="pre">num_layers</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.num_layers" title="Permalink to this definition"></a></dt>
<dd><p>Number of image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the fused layers.
Final dimension of the image data after image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.loss" title="Permalink to this definition"></a></dt>
<dd><p>Loss function. Depends on the prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">loss</span></span><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Loss function. Depends on the prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.activation">
<span class="sig-name descname"><span class="pre">activation</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.activation" title="Permalink to this definition"></a></dt>
<dd><p>Activation function. Depends on the prediction type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiclass_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialise the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dims</strong> (<em>list</em>) – List containing the dimensions of the data.</p></li>
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction.</p></li>
<li><p><strong>multiclass_dims</strong> (<em>int</em>) – Number of classes for multiclass classification.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.configure_optimizers" title="Permalink to this definition"></a></dt>
<dd><p>Configure the optimizers of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adam optimizer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.optim.Adam</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.get_intermediate_featuremaps">
<span class="sig-name descname"><span class="pre">get_intermediate_featuremaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.get_intermediate_featuremaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.get_intermediate_featuremaps" title="Permalink to this definition"></a></dt>
<dd><p>Get the intermediate feature maps to concatenate with the tabular latent subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intermediate feature maps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Training step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Input batch.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#ImgUnimodalDAE.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Validation step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em>) – Input batch.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – Batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">denoising_autoencoder_subspace_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#denoising_autoencoder_subspace_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing the method to train the denoising autoencoder and to convert the image data
to the latent image space.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.datamodule">
<span class="sig-name descname"><span class="pre">datamodule</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.datamodule" title="Permalink to this definition"></a></dt>
<dd><p>Data module containing the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pl.LightningDataModule</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.dae_trainer">
<span class="sig-name descname"><span class="pre">dae_trainer</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.dae_trainer" title="Permalink to this definition"></a></dt>
<dd><p>Trainer for the denoising autoencoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pl.Trainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.img_unimodal_trainer">
<span class="sig-name descname"><span class="pre">img_unimodal_trainer</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.img_unimodal_trainer" title="Permalink to this definition"></a></dt>
<dd><p>Trainer for the image unimodal network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pl.Trainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.autoencoder">
<span class="sig-name descname"><span class="pre">autoencoder</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.autoencoder" title="Permalink to this definition"></a></dt>
<dd><p>Tabular denoising autoencoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fusion_models.denoise_tab_img_maps.DenoisingAutoencoder" title="fusion_models.denoise_tab_img_maps.DenoisingAutoencoder">DenoisingAutoencoder</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.img_unimodal">
<span class="sig-name descname"><span class="pre">img_unimodal</span></span><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.img_unimodal" title="Permalink to this definition"></a></dt>
<dd><p>Image unimodal network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fusion_models.denoise_tab_img_maps.ImgUnimodalDAE" title="fusion_models.denoise_tab_img_maps.ImgUnimodalDAE">ImgUnimodalDAE</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#denoising_autoencoder_subspace_method.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datamodule</strong> (<em>pl.LightningDataModule</em>) – Data module containing the data.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs. Default is 1000.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>list</em>) – List containing the checkpoint paths for the denoising autoencoder and the image
unimodal network. Default is None - which means that the model needs training.</p></li>
<li><p><strong>own_early_stopping_callback</strong> (<em>pytorch lightning callback</em>) – Early stopping callback object. Default None. If None, the default early stopping
will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.convert_to_latent">
<span class="sig-name descname"><span class="pre">convert_to_latent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#denoising_autoencoder_subspace_method.convert_to_latent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.convert_to_latent" title="Permalink to this definition"></a></dt>
<dd><p>Convert the image data to the latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_dataset</strong> (<em>Dataset</em>) – Test dataset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – List containing the raw tabular data and the latent image space.</p></li>
<li><p><em>pd.DataFrame</em> – Dataframe containing the labels.</p></li>
<li><p><em>list</em> – List containing the dimensions of the data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.subspace_models">
<span class="sig-name descname"><span class="pre">subspace_models</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;class</span> <span class="pre">'fusion_models.denoise_tab_img_maps.DenoisingAutoencoder'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'fusion_models.denoise_tab_img_maps.ImgUnimodalDAE'&gt;]</span></em><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.subspace_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/denoise_tab_img_maps.html#denoising_autoencoder_subspace_method.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.denoise_tab_img_maps.denoising_autoencoder_subspace_method.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the latent image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataset</strong> (<em>Dataset</em>) – Training dataset.</p></li>
<li><p><strong>val_dataset</strong> (<em>Dataset</em>) – Validation dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – List containing the raw tabular data and the latent image space.</p></li>
<li><p><em>pd.DataFrame</em> – Dataframe containing the labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.edge_corr_gnn">
<span id="fusion-models-edge-corr-gnn-module"></span><h2>fusion_models.edge_corr_gnn module<a class="headerlink" href="#module-fusion_models.edge_corr_gnn" title="Permalink to this heading"></a></h2>
<p>Edge correlation GNN model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EdgeCorrGNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Graph neural network with the edge weighting as the first tabular modality correlations and
the node features as the second tabular modality features.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.graph_maker">
<span class="sig-name descname"><span class="pre">graph_maker</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.graph_maker" title="Permalink to this definition"></a></dt>
<dd><p>Function that creates the graph data structure: <a class="reference internal" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker" title="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">EdgeCorrGraphMaker</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.graph_conv_layers">
<span class="sig-name descname"><span class="pre">graph_conv_layers</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.graph_conv_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the graph convolutional layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.dropout_prob">
<span class="sig-name descname"><span class="pre">dropout_prob</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.dropout_prob" title="Permalink to this definition"></a></dt>
<dd><p>Dropout probability. Default: 0.5</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers. The final prediction layers
take in 256 features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGNN.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGNN.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the number of features after the fusion layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Tensor containing the tabular data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'graph'</span></em><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">graph_maker</span></span><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker" title="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">EdgeCorrGraphMaker</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Edge</span> <span class="pre">Correlation</span> <span class="pre">GNN'</span></em><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGNN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGNN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EdgeCorrGraphMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGraphMaker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates the graph data structure for the edge correlation GNN model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.dataset" title="Permalink to this definition"></a></dt>
<dd><p>Dataset containing the tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.utils.data.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.threshold" title="Permalink to this definition"></a></dt>
<dd><p>How correlated the nodes need to be to be connected. Default: 0.8</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGraphMaker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – Dataset containing the tabular data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.check_params">
<span class="sig-name descname"><span class="pre">check_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGraphMaker.check_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.check_params" title="Permalink to this definition"></a></dt>
<dd><p>Checks the parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.make_graph">
<span class="sig-name descname"><span class="pre">make_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/edge_corr_gnn.html#EdgeCorrGraphMaker.make_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.edge_corr_gnn.EdgeCorrGraphMaker.make_graph" title="Permalink to this definition"></a></dt>
<dd><p>Creates the graph data structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Graph data structure containing the tabular data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch_geometric.data.Data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.img_tab_channelwise_att">
<span id="fusion-models-img-tab-channelwise-att-module"></span><h2>fusion_models.img_tab_channelwise_att module<a class="headerlink" href="#module-fusion_models.img_tab_channelwise_att" title="Permalink to this heading"></a></h2>
<p>Image-channel-wise attention fusion model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ImageChannelWiseMultiAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_channelwise_att.html#ImageChannelWiseMultiAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Channel-wise multiplication net with image and tabular</p>
<p>If the tabular layers and the image layers have different feature maps dimensions at each
layer, the model will use a linear layer to make the tabular dimensions equal to the image
layer dimensions. This is done to ensure that the channel-wise multiplication can be performed.</p>
<p>Inspired by the work of Duanmu et al. (2020) [1]., we use channel-wise multiplication to combine
tabular data and image data.</p>
<p class="rubric">References</p>
<p>Duanmu, H., Huang, P. B., Brahmavar, S., Lin, S., Ren, T., Kong, J.,
Wang, F., &amp; Duong, T. Q. (2020).
Prediction of Pathological Complete Response to Neoadjuvant Chemotherapy in Breast
Cancer Using Deep Learning with Integrative Imaging, Molecular and Demographic Data. In A.
L. Martel, P. Abolmaesumi,
D. Stoyanov, D. Mateus, M. A. Zuluaga, S. K. Zhou, D. Racoceanu, &amp; L. Joskowicz (Eds.),
Medical Image Computing and Computer Assisted Intervention – MICCAI 2020
(pp. 242–252).
Springer International Publishing. <a class="reference external" href="https://doi.org/10.1007/978-3-030-59713-9_24">https://doi.org/10.1007/978-3-030-59713-9_24</a></p>
<p>Accompanying code: (our model is inspired by the work of Duanmu et al. (2020) [1])
<a class="reference external" href="https://github.com/HongyiDuanmu26/Prediction-of-pCR-with-Integrative-Deep-Learning/">https://github.com/HongyiDuanmu26/Prediction-of-pCR-with-Integrative-Deep-Learning/</a>
blob/main/CustomNet.py</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.match_dim_layers">
<span class="sig-name descname"><span class="pre">match_dim_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.match_dim_layers" title="Permalink to this definition"></a></dt>
<dd><p>Module dictionary containing the linear layers to make the dimensions of the two types of
data the same. This is done to ensure that the channel-wise multiplication can be performed.
This doesn’t change the mod1_layers or img_layers, it just makes the outputs multipliable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the flattened output size of the
image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_channelwise_att.html#ImageChannelWiseMultiAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_channelwise_att.html#ImageChannelWiseMultiAttention.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the number of layers in the two modalities is not the same.</p></li>
<li><p><strong>ValueError</strong> – If dtype of the layers is not nn.ModuleDict.</p></li>
<li><p><strong>ValueError</strong> – If the image dimensions are not valid. (Conv2D used for 3D img and vice versa)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_channelwise_att.html#ImageChannelWiseMultiAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Tensor containing the image data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'attention'</span></em><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_channelwise_att.html#ImageChannelWiseMultiAttention.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Channel-wise</span> <span class="pre">multiplication</span> <span class="pre">net</span> <span class="pre">(image)'</span></em><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.img_tab_channelwise_att.ImageChannelWiseMultiAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.img_tab_decision">
<span id="fusion-models-img-tab-decision-module"></span><h2>fusion_models.img_tab_decision module<a class="headerlink" href="#module-fusion_models.img_tab_decision" title="Permalink to this heading"></a></h2>
<p>Model that fuses the first tabular data and the image data using a decision
fusion approach.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ImageDecision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_decision.html#ImageDecision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>This class implements a model that fuses the first tabular data and the image data using a decision fusion</dt><dd><p>approach.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.final_prediction_tab1">
<span class="sig-name descname"><span class="pre">final_prediction_tab1</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.final_prediction_tab1" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers for the first tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.final_prediction_img">
<span class="sig-name descname"><span class="pre">final_prediction_img</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.final_prediction_img" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers for the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.fusion_operation">
<span class="sig-name descname"><span class="pre">fusion_operation</span></span><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.fusion_operation" title="Permalink to this definition"></a></dt>
<dd><p>Function that performs the fusion operation. Default is torch.mean(torch.stack([x, y]), dim=0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">..</span> <span class="pre">warning::</span></span></dt>
<dd><p><cite>fusion_operation</cite> should be done on the first dimension, i.e. the batch dimension.
For example, <cite>lambda x: torch.mean(x, dim=1)</cite>.
The predictions of the different modalities are stacked on the first dimension before
<cite>fusion_operation</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_decision.html#ImageDecision.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_decision.html#ImageDecision.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fusion layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_tab_decision.html#ImageDecision.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'decision'</span></em><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Image</span> <span class="pre">decision</span> <span class="pre">fusion'</span></em><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tab_img'</span></em><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_tab_decision.ImageDecision.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.img_tab_decision.ImageDecision.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.img_unimodal">
<span id="fusion-models-img-unimodal-module"></span><h2>fusion_models.img_unimodal module<a class="headerlink" href="#module-fusion_models.img_unimodal" title="Permalink to this heading"></a></h2>
<p>Uni-modal model using only the image data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ImgUnimodal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_unimodal.html#ImgUnimodal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>This class implements a uni-modal model using only the image data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.img_layers">
<span class="sig-name descname"><span class="pre">img_layers</span></span><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.img_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the image data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the flattened output size of the
image layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_unimodal.html#ImgUnimodal.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_unimodal.html#ImgUnimodal.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_unimodal.html#ImgUnimodal.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Tensor containing the image data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_pred</strong> – List containing the predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Uni-modal'</span></em><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/img_unimodal.html#ImgUnimodal.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Image</span> <span class="pre">unimodal'</span></em><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'img'</span></em><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.img_unimodal.ImgUnimodal.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.img_unimodal.ImgUnimodal.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.mcvae_tab">
<span id="fusion-models-mcvae-tab-module"></span><h2>fusion_models.mcvae_tab module<a class="headerlink" href="#module-fusion_models.mcvae_tab" title="Permalink to this heading"></a></h2>
<p>This module implements the MCVAE (multi-channel variational autoencoder) model for fusing
two types of tabular data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MCVAESubspaceMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for creating the MCVAE (multi-channel variational autoencoder) joint latent space.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.datamodule">
<span class="sig-name descname"><span class="pre">datamodule</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.datamodule" title="Permalink to this definition"></a></dt>
<dd><p>Datamodule object containing the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datamodule object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.num_latent_dims">
<span class="sig-name descname"><span class="pre">num_latent_dims</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.num_latent_dims" title="Permalink to this definition"></a></dt>
<dd><p>Number of latent dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.fit_model">
<span class="sig-name descname"><span class="pre">fit_model</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.fit_model" title="Permalink to this definition"></a></dt>
<dd><p>Mcvae object containing the fitted model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mcvae object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datamodule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datamodule</strong> (<em>datamodule object</em>) – Datamodule object containing the data.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of epochs, by default 5000</p></li>
<li><p><strong>checkpoint_path</strong> (<em>list</em><em>, </em><em>optional</em>) – List containing the path to the checkpoint, by default None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.check_params">
<span class="sig-name descname"><span class="pre">check_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod.check_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.check_params" title="Permalink to this definition"></a></dt>
<dd><p>Checks the parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.convert_to_latent">
<span class="sig-name descname"><span class="pre">convert_to_latent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod.convert_to_latent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.convert_to_latent" title="Permalink to this definition"></a></dt>
<dd><p>Converts the test dataset to the latent space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_dataset</strong> (<em>list</em>) – List containing the two types of tabular data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>test_mean_latents</strong> (<em>torch.Tensor</em>) – Tensor containing the mean latents of the dataset.</p></li>
<li><p><strong>labels</strong> (<em>pd.DataFrame</em>) – Dataframe containing the labels of the dataset.</p></li>
<li><p><strong>[self.num_latent_dims, None, None]</strong> (<em>list</em>) – List containing the dimensions of the data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.get_latents">
<span class="sig-name descname"><span class="pre">get_latents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod.get_latents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.get_latents" title="Permalink to this definition"></a></dt>
<dd><p>Gets the latent representations of the multimodal dataset.
The two latent spaces are averaged to form the joint latent space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>list</em>) – List containing the two types of tabular data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mean_latents</strong> – Array containing the mean latents of the dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.subspace_models">
<span class="sig-name descname"><span class="pre">subspace_models</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;class</span> <span class="pre">'fusilli.utils.mcvae.src.mcvae.models.mcvae.Mcvae'&gt;]</span></em><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.subspace_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAESubspaceMethod.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAESubspaceMethod.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataset</strong> (<em>list</em>) – List containing the two types of tabular data.</p></li>
<li><p><strong>val_dataset</strong> (<em>list</em><em>, </em><em>optional</em>) – List containing the two types of tabular data, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_latents</strong> (<em>torch.Tensor</em>) – Tensor containing the mean latents of the dataset.</p></li>
<li><p><strong>labels</strong> (<em>pd.DataFrame</em>) – Dataframe containing the labels of the dataset.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MCVAE_tab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAE_tab"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>This class implements a model that fuses the two types of tabular data using the MCVAE approach.
MCVAE: multi-channel variational autoencoder.</p>
<p>The MCVAE creates a joint latent space of the two types of tabular data based off a joint
latent prior and joint decoding.</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>Antelmi, L., Ayache, N., Robert, P., &amp; Lorenzi, M. (2019). Sparse Multi-Channel Variational</dt><dd><p>Autoencoder for the Joint Analysis of Heterogeneous Data. Proceedings of the 36th
International Conference on Machine Learning, 302–311.
<a class="reference external" href="https://proceedings.mlr.press/v97/antelmi19a.html">https://proceedings.mlr.press/v97/antelmi19a.html</a></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.subspace_method">
<span class="sig-name descname"><span class="pre">subspace_method</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.subspace_method" title="Permalink to this definition"></a></dt>
<dd><p>Class of the subspace method: <a class="reference internal" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod" title="fusion_models.mcvae_tab.MCVAESubspaceMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCVAESubspaceMethod</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.latent_space_layers">
<span class="sig-name descname"><span class="pre">latent_space_layers</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.latent_space_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.
Here the first type of tabular data is the joint latent space created
in the mcvae_subspace_method class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the flattened output size of the
latent space layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAE_tab.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAE_tab.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fused layers of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#MCVAE_tab.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the two types of tabular data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_pred</strong> – List containing the predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'subspace'</span></em><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'MCVAE</span> <span class="pre">Tabular'</span></em><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">subspace_method</span></span><a class="headerlink" href="#id3" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#fusion_models.mcvae_tab.MCVAESubspaceMethod" title="fusion_models.mcvae_tab.MCVAESubspaceMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCVAESubspaceMethod</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.MCVAE_tab.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.mcvae_tab.MCVAE_tab.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fusion_models.mcvae_tab.mcvae_early_stopping_tol">
<span class="sig-name descname"><span class="pre">mcvae_early_stopping_tol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patience</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/mcvae_tab.html#mcvae_early_stopping_tol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.mcvae_tab.mcvae_early_stopping_tol" title="Permalink to this definition"></a></dt>
<dd><p>Simple early stopping function for the MCVAE model’s training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> (<em>int</em>) – Number of epochs to wait before stopping</p></li>
<li><p><strong>tolerance</strong> (<em>int</em>) – Tolerance for loss</p></li>
<li><p><strong>loss_logs</strong> (<em>list</em>) – List of loss logs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print out information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>i</strong> – Epoch to stop at</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fusion_models.tab_crossmodal_att">
<span id="fusion-models-tab-crossmodal-att-module"></span><h2>fusion_models.tab_crossmodal_att module<a class="headerlink" href="#module-fusion_models.tab_crossmodal_att" title="Permalink to this heading"></a></h2>
<p>Crossmodal multi-head attention for tabular data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TabularCrossmodalMultiheadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tab_crossmodal_att.html#TabularCrossmodalMultiheadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Tabular Crossmodal multi-head attention model.</p>
<p>This class implements a model that fuses the two types of tabular data using a
cross-modal multi-head attention approach.</p>
<p>Inspired by the work of Golovanevsky et al. (2021) [1]: here we use two types of tabular data as
the multi-modal data instead of 3 types in the paper.</p>
<p class="rubric">References</p>
<p>Golovanevsky, M., Eickhoff, C., &amp; Singh, R. (2022). Multimodal attention-based
deep learning for Alzheimer’s disease diagnosis.
Journal of the American Medical Informatics Association, 29(12),
2014–2022. <a class="reference external" href="https://doi.org/10.1093/jamia/ocac168">https://doi.org/10.1093/jamia/ocac168</a></p>
<p>Accompanying code: (our model is inspired by the work of Golovanevsky et al. (2021) [1])
<a class="reference external" href="https://github.com/rsinghlab/MADDi/blob/main/training/train_all_modalities.py">https://github.com/rsinghlab/MADDi/blob/main/training/train_all_modalities.py</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.pred_type">
<span class="sig-name descname"><span class="pre">pred_type</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.pred_type" title="Permalink to this definition"></a></dt>
<dd><p>Type of prediction to be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.attention_embed_dim">
<span class="sig-name descname"><span class="pre">attention_embed_dim</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.attention_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the first modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the second modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the flattened output size of the
first tabular modality’s layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.attention">
<span class="sig-name descname"><span class="pre">attention</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.attention" title="Permalink to this definition"></a></dt>
<dd><p>Multihead attention layer. Takes in attention_embed_dim features as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.MultiheadAttention</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.tab1_to_embed_dim">
<span class="sig-name descname"><span class="pre">tab1_to_embed_dim</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.tab1_to_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer. Takes in fused_dim features as input. This is the input of the
multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.tab2_to_embed_dim">
<span class="sig-name descname"><span class="pre">tab2_to_embed_dim</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.tab2_to_embed_dim" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer. Takes in fused_dim features as input. This is the input of the
multihead attention layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.relu">
<span class="sig-name descname"><span class="pre">relu</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.relu" title="Permalink to this definition"></a></dt>
<dd><p>ReLU activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ReLU</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tab_crossmodal_att.html#TabularCrossmodalMultiheadAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tab_crossmodal_att.html#TabularCrossmodalMultiheadAttention.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the number of layers in the two modalities is not the same.</p></li>
<li><p><strong>ValueError</strong> – If dtype of the layers is not nn.ModuleDict.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tab_crossmodal_att.html#TabularCrossmodalMultiheadAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'attention'</span></em><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tabular</span> <span class="pre">Crossmodal</span> <span class="pre">multi-head</span> <span class="pre">attention'</span></em><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.tab_crossmodal_att.TabularCrossmodalMultiheadAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.tabular1_unimodal">
<span id="fusion-models-tabular1-unimodal-module"></span><h2>fusion_models.tabular1_unimodal module<a class="headerlink" href="#module-fusion_models.tabular1_unimodal" title="Permalink to this heading"></a></h2>
<p>Tabular1 uni-modal model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tabular1Unimodal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular1_unimodal.html#Tabular1Unimodal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Uni-modal model for tabular data.</p>
<p>This class implements a uni-modal model using only the 1st type of tabular data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the fused layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular1_unimodal.html#Tabular1Unimodal.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular1_unimodal.html#Tabular1Unimodal.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the fused layers.</p>
<p>If the mod1_layers are modified, this function will recalculate the fused layers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular1_unimodal.html#Tabular1Unimodal.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Uni-modal'</span></em><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.fusion_type" title="Permalink to this definition"></a></dt>
<dd><p>Fusion type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular1_unimodal.html#Tabular1Unimodal.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tabular1</span> <span class="pre">uni-modal'</span></em><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.method_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tabular1'</span></em><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.modality_type" title="Permalink to this definition"></a></dt>
<dd><p>Modality type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular1_unimodal.Tabular1Unimodal.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.tabular1_unimodal.Tabular1Unimodal.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.tabular2_unimodal">
<span id="fusion-models-tabular2-unimodal-module"></span><h2>fusion_models.tabular2_unimodal module<a class="headerlink" href="#module-fusion_models.tabular2_unimodal" title="Permalink to this heading"></a></h2>
<p>Tabular2 uni-modal model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tabular2Unimodal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular2_unimodal.html#Tabular2Unimodal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Tabular2 uni-modal model.</p>
<p>This class implements a uni-modal model using only the 2nd type of tabular data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 2nd type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the fused layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#id4" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of the fused layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular2_unimodal.html#Tabular2Unimodal.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular2_unimodal.html#Tabular2Unimodal.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular2_unimodal.html#Tabular2Unimodal.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Uni-modal'</span></em><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular2_unimodal.html#Tabular2Unimodal.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tabular2</span> <span class="pre">uni-modal'</span></em><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tabular2'</span></em><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular2_unimodal.Tabular2Unimodal.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.tabular2_unimodal.Tabular2Unimodal.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.tabular_channelwise_att">
<span id="fusion-models-tabular-channelwise-att-module"></span><h2>fusion_models.tabular_channelwise_att module<a class="headerlink" href="#module-fusion_models.tabular_channelwise_att" title="Permalink to this heading"></a></h2>
<p>Channel-wise multiplication fusion model for tabular data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TabularChannelWiseMultiAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_channelwise_att.html#TabularChannelWiseMultiAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Channel-wise multiplication fusion model for tabular data.</p>
<p>This class implements a model that fuses the two types of tabular data using a
channel-wise multiplication approach.</p>
<p>If the two types of tabular data have different feature dimensions at each layer, the model will
use a linear layer to make the dimensions the same. This is done to ensure that the
channel-wise multiplication can be performed.</p>
<p>Inspired by the work of Duanmu et al. (2020) [1]: here we use two types of tabular data as
the multi-modal data instead of image and non-image like in the paper.</p>
<p class="rubric">References</p>
<p>Duanmu, H., Huang, P. B., Brahmavar, S., Lin, S., Ren, T., Kong, J., Wang, F.,
&amp; Duong, T. Q. (2020).
Prediction of Pathological Complete Response to Neoadjuvant Chemotherapy in Breast
Cancer Using Deep
Learning with Integrative Imaging, Molecular and Demographic Data. In A. L. Martel,
P. Abolmaesumi,
D. Stoyanov, D. Mateus, M. A. Zuluaga, S. K. Zhou, D. Racoceanu, &amp; L. Joskowicz (Eds.),
Medical Image Computing and Computer Assisted Intervention – MICCAI 2020 (pp. 242–252).
Springer International Publishing. <a class="reference external" href="https://doi.org/10.1007/978-3-030-59713-9_24">https://doi.org/10.1007/978-3-030-59713-9_24</a></p>
<p>Accompanying code: (our model is inspired by the work of Duanmu et al. (2020) [1])
<a class="reference external" href="https://github.com/HongyiDuanmu26/Prediction-of-pCR-with-Integrative-Deep-Learning/">https://github.com/HongyiDuanmu26/Prediction-of-pCR-with-Integrative-Deep-Learning/</a>
blob/main/CustomNet.py</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 2nd type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.match_dim_layers">
<span class="sig-name descname"><span class="pre">match_dim_layers</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.match_dim_layers" title="Permalink to this definition"></a></dt>
<dd><p>Module dictionary containing the linear layers to make the dimensions of the two types of
tabular data the same. This is done to ensure that the channel-wise multiplication can be
performed. This doesn’t change the mod1_layers or mod2_layers, it just makes the outputs
multipliable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fused_dim">
<span class="sig-name descname"><span class="pre">fused_dim</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Number of features of the fused layers. This is the output size of the
2nd type of tabular data’s layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.final_prediction">
<span class="sig-name descname"><span class="pre">final_prediction</span></span><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.final_prediction" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_channelwise_att.html#TabularChannelWiseMultiAttention.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_channelwise_att.html#TabularChannelWiseMultiAttention.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fusion layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the number of layers in the two modalities is different.</p></li>
<li><p><strong>ValueError</strong> – If dtype of the layers is not nn.ModuleDict.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_channelwise_att.html#TabularChannelWiseMultiAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the input data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the output of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'attention'</span></em><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.get_fused_dim">
<span class="sig-name descname"><span class="pre">get_fused_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_channelwise_att.html#TabularChannelWiseMultiAttention.get_fused_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.get_fused_dim" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of features of the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Channel-wise</span> <span class="pre">multiplication</span> <span class="pre">net</span> <span class="pre">(tabular)'</span></em><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.tabular_channelwise_att.TabularChannelWiseMultiAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models.tabular_decision">
<span id="fusion-models-tabular-decision-module"></span><h2>fusion_models.tabular_decision module<a class="headerlink" href="#module-fusion_models.tabular_decision" title="Permalink to this heading"></a></h2>
<p>Decision fusion of two types of tabular data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TabularDecision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_decision.html#TabularDecision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../autosummary/fusilli.fusion_models.base_model.html#fusilli.fusion_models.base_model.ParentFusionModel" title="fusilli.fusion_models.base_model.ParentFusionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParentFusionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>This class implements a model that fuses the two types of tabular data using a decision fusion</dt><dd><p>approach.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.mod1_layers">
<span class="sig-name descname"><span class="pre">mod1_layers</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.mod1_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 1st type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.mod2_layers">
<span class="sig-name descname"><span class="pre">mod2_layers</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.mod2_layers" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the layers of the 2nd type of tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.fused_layers">
<span class="sig-name descname"><span class="pre">fused_layers</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the fused layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.final_prediction_tab1">
<span class="sig-name descname"><span class="pre">final_prediction_tab1</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.final_prediction_tab1" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers for the first tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.final_prediction_tab2">
<span class="sig-name descname"><span class="pre">final_prediction_tab2</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.final_prediction_tab2" title="Permalink to this definition"></a></dt>
<dd><p>Sequential layer containing the final prediction layers for the second tabular data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Sequential</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.fusion_operation">
<span class="sig-name descname"><span class="pre">fusion_operation</span></span><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.fusion_operation" title="Permalink to this definition"></a></dt>
<dd><p>Function that performs the fusion operation. Default is torch.mean(torch.stack([x, y]), dim=0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_decision.html#TabularDecision.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_type</strong> (<em>str</em>) – Type of prediction to be performed.</p></li>
<li><p><strong>data_dims</strong> (<em>dict</em>) – Dictionary containing the dimensions of the data.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the parameters of the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.calc_fused_layers">
<span class="sig-name descname"><span class="pre">calc_fused_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_decision.html#TabularDecision.calc_fused_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.calc_fused_layers" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the fusion layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fusion_models/tabular_decision.html#TabularDecision.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>list</em>) – List containing the two types of tabular data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing the fused prediction.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.fusion_type">
<span class="sig-name descname"><span class="pre">fusion_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'operation'</span></em><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.fusion_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.method_name">
<span class="sig-name descname"><span class="pre">method_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tabular</span> <span class="pre">decision'</span></em><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.method_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.modality_type">
<span class="sig-name descname"><span class="pre">modality_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both_tab'</span></em><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.modality_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fusion_models.tabular_decision.TabularDecision.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fusion_models.tabular_decision.TabularDecision.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-fusion_models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fusion_models" title="Permalink to this heading"></a></h2>
<p>Fusion models: one py file per model</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Florence J Townend.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>